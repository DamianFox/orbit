@(report: models.statistics.Report, statsList: List[Long])
@main(Html(report.name + ""), nav = "report-" + report.id, nav2 = "", null) {

<style type="text/css">
    .full-report-chart {
        background-color: whiteSmoke;
        width: 100%; 
        
        /* BORDER RADIOUS */
        border: 1px solid #efefef;
        -webkit-border-radius: 6px;
        -moz-border-radius: 6px;
        border-radius: 6px;        
    }
    .chart {
        height: 400px;
    }
</style>
<!-- 
 TODO:  
 - creazione e / o clonazione template
 - inserimento valori liste
 - controllo valori errati
 - pulizia!
-->
<script src="@routes.Assets.at("javascripts/jquery.templ.js")"></script>
<script>
    $.each(@statsList, function(i, statID) {
        var getStatsUrl = '/statistic/' + statID + '/';
           
        $.ajax({
            url: getStatsUrl,
            dataType: 'json',
            data: '',
            success: function(stat_data) {
               // The tile of current chart
               var chart_title = stat_data.title;
               
               // The descrption of current chart
               var chart_descr = stat_data.description;
               
               // The type of current chart
               var chart_type = stat_data.type;
               
               
               chart_type = "PieChart"; // FIX: errore nel tipo di grafico (pieChart > PieChart)
               
               var chart_columns = stat_data.columns;
               var chart_data = stat_data.data;
               var chart_templ_data = [ 
                                  { title: chart_title, 
                                    description: chart_descr,
                                    type: chart_type } ];
               
               // TEMPLATE
               var container = $("#full-report-cont").tmpl(chart_templ_data).appendTo("#report-container");
               
               var data; 
               var chart;
               
               /* Loading chart here */
               google.load("visualization", "1", {packages:["corechart"]}); // FIXME: considerare se spostarlo fuori dal for each
               //google.setOnLoadCallback(drawChart);
                              
               data = new google.visualization.DataTable();               
               
               // Adds columns to Data Table
               $.each(chart_columns, function(i, column) {
                      var type = column[0];
                      var name = column[1];
                      
                      data.addColumn(column[0], column[1]);
               });
               
               // Adds rows to Data Table
               data.addRows(chart_data);
               //alert(chart_data);
                        
               //var options = {'title':'How Much Pizza I Ate Last Night', 'width':400, 'height':300};
               var options = {'':''};
               
               // Instantiate and draw our chart, passing in some options.
               
               //chart = new google.visualization.PieChart(document.getElementById('chart-full-report'));
               chart = new google.visualization.PieChart(container.find(".chart").get(0));
               chart.draw(data, options);
            },
            error: function() { // TODO: gestione errori
               $('body').append('<div class="alert alert-error">Error: ajax call (url: ' + getStatsUrl + ' )</div>');
            }
        });
    });
    
</script>
    
<!-- full size chart -->
<script id="full-report-cont" class="full-stat-cont" type="text/html">
    <div class="row-fluid report-inner-container">
        <h3 class="stat-title">${title}</h3>
        <h4 class="stat-descr">${description}</h4>

        <div class="chart" style="">${type}</div>
    </div>
</script>
<!-- half size chart -->
<script class="half-stat-cont"></script>

<div class="alert alert-warning">Debug: statsList @statsList</div>
<div id="report-container"></div>

}